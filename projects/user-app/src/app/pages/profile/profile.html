<ng-container *transloco="let t">
  <div class="container">
    <h2>{{ t('PROFILE.TITLE') }}</h2>

    <div class="profile-grid">
      <mat-card>
        <mat-card-header>
          <mat-card-title>{{ user()?.name }}</mat-card-title>
          <mat-card-subtitle>{{ user()?.email }}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p>
            {{ t('PROFILE.ROLE') }}:
            {{ user()?.groupRole ? user()?.groupRole : user()?.isAdmin ? 'Global Admin' : 'User' }}
          </p>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title>{{ t('PROFILE.SETTINGS') }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-form-field appearance="outline" style="width: 100%; margin-top: 10px">
            <mat-label>{{ t('PROFILE.LANG') }}</mat-label>
            <mat-select
              [value]="selectedLanguage()"
              (selectionChange)="saveSettingsLanguage($event.value)"
            >
              <mat-option value="en">{{ t('PROFILE.LANG_EN') }}</mat-option>
              <mat-option value="de">{{ t('PROFILE.LANG_DE') }}</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="outline" style="width: 100%; margin-top: 10px">
            <mat-label>{{ t('PROFILE.EMAIL_LANG') }}</mat-label>
            <mat-select
              [value]="selectedLanguage()"
              (selectionChange)="saveSettingsEmailLanguage($event.value)"
            >
              <mat-option value="en">{{ t('PROFILE.LANG_EN') }}</mat-option>
              <mat-option value="de">{{ t('PROFILE.LANG_DE') }}</mat-option>
            </mat-select>
          </mat-form-field>
        </mat-card-content>
      </mat-card>

      @if (!user()?.has2FA) {
      <mat-card class="security-card warning">
        <mat-card-header>
          <mat-icon color="warn">warning</mat-icon>
          <mat-card-title>{{ t('PROFILE.SEC_TITLE_WARN') }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ t('PROFILE.SEC_DESC') }}</p>
        </mat-card-content>
        <mat-card-actions align="end" class="action-buttons">
          <button mat-stroked-button (click)="changePassword()">
            <mat-icon>lock</mat-icon> {{ t('PROFILE.BTN_PW') }}
          </button>
          <button mat-stroked-button color="accent" (click)="open2FA()">
            <mat-icon>security</mat-icon> {{ t('PROFILE.BTN_2FA') }}
          </button>
        </mat-card-actions>
      </mat-card>
      } @else {
      <mat-card class="security-card success">
        <mat-card-header>
          <mat-icon class="shield-icon">verified_user</mat-icon>
          <mat-card-title>{{ t('DASHBOARD.SEC_TITLE_OK') }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ t('DASHBOARD.SEC_DESC_OK') }}</p>
        </mat-card-content>
        <mat-card-actions align="end" class="action-buttons">
          <button mat-stroked-button (click)="changePassword()">
            <mat-icon>lock</mat-icon> {{ t('PROFILE.BTN_PW') }}
          </button>
          <button mat-stroked-button color="accent" (click)="open2FA()">
            <mat-icon>security</mat-icon> {{ t('PROFILE.BTN_2FA') }}
          </button>
        </mat-card-actions>
      </mat-card>
      }

      <mat-card class="danger-zone">
        <mat-card-header>
          <mat-card-title class="warn-text">{{ t('PROFILE.DANGER_ZONE') }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <p>{{ t('PROFILE.DELETE_DESC') }}</p>
        </mat-card-content>
        <mat-card-actions align="end">
          <button mat-flat-button color="warn" (click)="deleteAccount()">
            <mat-icon>delete_forever</mat-icon> {{ t('PROFILE.DELETE_ACCOUNT') }}
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</ng-container>
